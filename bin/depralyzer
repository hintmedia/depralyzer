#!/usr/bin/env ruby
#
# depralyzer [dir/*.rb]
#

require 'optparse'
require 'depralyzer/version'
require 'depralyzer/generator'

print_version = false
spec_dir      = './spec'
exc_spec_dir  = nil

opt = OptionParser.new

opt.on('-o VAL', 'Output file') { |dir| outfile = dir }
opt.on('--output-file VAL', '') { |dir| outfile = dir }

opt.on('-v', 'Print version') { |_| print_version = true }
opt.on('--version', '') { |_| print_version = true }

args = opt.parse(ARGV)

if print_version
  puts "depralyzer #{Depralyzer::VERSION}"
  exit 0
end

dir_or_file = args.first
if dir_or_file.nil?
  puts "Usage: depralyzer [dir/*.log] -options"
  exit 1
end

generator = Depralyzer::Generator.new(outfile)
generator.process

